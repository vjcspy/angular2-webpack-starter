<!-- START Add new License page -->
<div class="addNew">
  <div class="white-box">
    <div>
      <div class="title-page">
        <h1>
          {{ license && license['_id'] ? "Update License" : "Create License"}}
          <span *ngIf="license">{{id}}</span>
        </h1>
      </div>
      <form class="js-validation-license form-horizontal form-addlicense">
        <div class="form-content box560">
          <div class="form-group">
            <label class="control-label" for="val-owner">Shop Owner</label>
            <div class="element">
              <select [disabled]="!!license && !!license['shop_owner_id']" class="js-select2 form-control" id="val-owner" name="val-owner" style="width: 100%;"
                      data-placeholder="Choose one.." [value]="license['shop_owner_id']">
                <option></option><!-- Required for data-placeholder attribute to work with Select2 plugin -->
                <option *ngFor="let user of users" [value]="user._id">{{ user.username }}</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label class="control-label" for="status">License status:</label>
            <div class="element">
              <select class="form-control" id="status" name="status" [(ngModel)]="license.status">
                <option value="1">Activated</option>
                <option value="0">Deactivated</option>
                <option value="2">Fresh</option>
              </select>
            </div>
          </div>
        </div>

        <table class="table table-responsive tbl-addlicense">
          <thead>
          <tr>
            <th>Choose Product</th>
            <th>Product Name</th>
            <th>Product status</th>
            <th>Start Version</th>
            <th>Pricing Plan</th>
            <th>Based URLs</th>
            <th>Purchased Date</th>
            <th>Active Date</th>
            <th>Expire Date</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let product of products;trackBy:product?.product_id">
            <td>
              <div class="form-material">
                <div class="col-xs-6">
                  <label class="css-input css-checkbox css-checkbox-primary">
                    <input type="checkbox" name="{{'product_id' + product['product_id']}}"
                           [checked]="product['checked']==true"
                           [(ngModel)]="product['checked']"><span></span>
                  </label>
                </div>
              </div>
            </td>
            <td>
              <div class="form-material">
                {{ product.name }}
              </div>
            </td>
            <td>
              <div class="form-group">
                <select class="form-control" [(ngModel)]="product['status']" id="val-status_product"
                        name="{{'status_product' + product['product_id']}}"
                        style="width: 100%;"
                        data-placeholder="Choose one..">
                  <option value=""></option>
                  <option value="1">Activated</option>
                  <option value="0">Deactivated</option>
                  <option value="2">Fresh</option>
                </select>
              </div>
            </td>
            <td>
              <div class="form-group">
                <select class="form-control" id="val-version"
                        name="{{'val-version'+product['product_id']}}"
                        style="width: 100%;"
                        data-placeholder="Choose one.." [(ngModel)]="product['start_version']">
                  <option></option><!-- Required for data-placeholder attribute to work with Select2 plugin -->
                  <option *ngFor="let version of product['versions']" [value]="version['version']">{{ version['version'] }}
                  </option>
                </select>
              </div>
            </td>
            <td>
              <div class="form-group">
                <select class="form-control" id="val-price" name="{{'val-price'+product['product_id']}}" style="width: 100%;"
                        data-placeholder="Choose one.." [(ngModel)]="product['pricing_id']">
                  <option></option><!-- Required for data-placeholder attribute to work with Select2 plugin -->
                  <ng-template ngFor let-price [ngForOf]="prices">
                    <option *ngIf="product.pricings && product.pricings.indexOf(price._id)>-1"
                            [value]="price._id">{{ price.name }}
                    </option>
                  </ng-template>

                </select>
              </div>
            </td>
            <td class="td-baseurl">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" class="form-control" placeholder="Enter URL here..." #base>
                  <span class="input-group-btn">
                                        <button class="btn btn-primary btn-plus" type="button" (click)="addBasedUrl(product, base.value)">
                                            <span class="ion-ios-plus-empty"></span>
                                    </button>
                                    </span>
                </div>
                <div class="input-group row baseurl-list" *ngFor="let baseUrl of product['base_url']">
                  <div class="col-sm-12">
                    <input class="form-control" type="text" disabled [value]="baseUrl['url']">
                    <div class="button-group">
                      <button *ngIf="baseUrl['status']" class="btn btn-success" title="Deactive" type="button"
                              (click)="toggleStatus(product, baseUrl)">
                        <i class="fa fa-check"></i>
                      </button>
                      <button *ngIf="!baseUrl['status']" class="btn btn-default" title="Active" type="button"
                              (click)="toggleStatus(product, baseUrl)">
                        <i class="fa fa-check"></i>
                      </button>
                      <button class="btn btn-default btn-orange" title="Remove" type="button" (click)="removeBaseUrl(product,baseUrl)">
                        <i class="fa fa-times"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </td>
            <td>
              <div class="form-group">
                <div class="form-material">
                  <input class="form-control" type="text" name="{{ 'val-purchased_date' + product['product_id'] }}"
                         id="{{ 'val-purchased_date' + product['product_id'] }}"
                         placeholder="Enter Purchased Date..">
                </div>
              </div>
            </td>
            <td>
              <div class="form-group">
                <div class="form-material">
                  <input class="form-control" type="text" name="{{ 'val-active_date' + product['product_id'] }}"
                         id="{{ 'val-active_date' + product['product_id'] }}"
                         placeholder="Enter Active Date..">
                </div>
              </div>
            </td>
            <td>
              <div class="form-group">
                <div class="form-material">
                  <input class="form-control" type="text" name="{{'val-expire_date'+product['product_id']}}"
                         id="{{ 'val-expire_date' + product['product_id'] }}"
                         placeholder="Enter Expire Date..">
                </div>
              </div>
            </td>
          </tr>
          </tbody>
        </table>

        <div class="group-btn tac line-top">
          <button type="button" (click)="router.navigate(['/cloud/license-management'])" class="btn btn-default">Cancel</button>
          <button type="submit" [disabled]="!!isLoading" class="btn btn-primary">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>
